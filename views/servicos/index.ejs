<% layout("../layout/index") -%>
<% block("title", "ON STORES | Serviços | " + nome_do_shopping_barra_titulo); -%>
   <div class="full">
    
        <aside class="sembanner">
        	<h1 class="titles">
        		<span class="tgrey" style="left:25%">Serviços</span>
        	</h1>
        </aside> <!--banner-->
  

<div class="filtroservice content">
   	<form action="" class="service">    	
        
        <div>
        	<label>O que você procura?</label>
            <input name="servico" id="servico" type="text" value="" placeholder="">
        </div>
         <div>
        	<label>Categoria</label>
            <select class="minimal aumenta" name="categoria" id="categoria">
            	<option value="">Todas</option>
                <option value="categoria 1">Categoria 1</option>
                <option value="categoria 2">Categoria 2</option>
                <option value="categoria 3">Categoria 3</option>
            </select>
        </div>

    </form>
   </div>   

       
 <!------------------Lojas---------------------->  

   <div id="servicos">   
		<% 
		if (resultados.length>0){
		resultados.forEach(function(resultado) { 
		%> 
    	<div class="serv">
			<span style="background-color:#000000">
            <img src="<%=caminho_imagem(resultado.mall)%><%=resultado.media.images.logo%>" title="<%=resultado.info.title%>"></span> 
            <h2>Descrição do serviço</h2>
            <div class="lineserv"></div>
            <span> <img src="imagens/icon-fone.jpg" width="39" height="39"> <%=resultado.contacts.telephone%></span>
            <span><img src="imagens/icon-location.jpg" width="39" height="39"> <%=resultado.position.floor%></span>
            <p><%=resultado.info.description%></p>
            
        </div>
         <% 
		}); 
		} else {
		%>
		
			
			<div class="serv" data-nome="serviço 1" data-categoria="categoria 1">
				<img src="imagens/servico1.jpg" title="Nome do evento"> 
				<h2>Serviço 1</h2>
				<div class="lineserv"></div>
				<span> <img src="imagens/icon-fone.jpg" width="39" height="39"> 011. 5567.7890</span>
				<span><img src="imagens/icon-location.jpg" width="39" height="39">  Piso Térreo</span>
				<p> Texto do conteudo menor que vem do dashboard.Texto do conteudo menor que vem do dashboard.</p>
				
			</div>
			
		   <div class="serv" data-nome="serviço 2" data-categoria="categoria 2">
				<img src="imagens/servico2.jpg" title="Nome do evento"> 
				<h2>Serviço 2</h2>
				<div class="lineserv"></div>
				<span> <img src="imagens/icon-fone.jpg" width="39" height="39"> 011. 5567.7890</span>
				<span><img src="imagens/icon-location.jpg" width="39" height="39">  Piso Térreo</span>
				<p> Texto do conteudo menor que vem do dashboard.</p>
				
			</div>
			
			<div class="serv" data-nome="serviço 3" data-categoria="categoria 3">
				<img src="imagens/servico3.jpg" title="Nome do evento"> 
				<h2>Serviço 3</h2>
				<div class="lineserv"></div>
				<span> <img src="imagens/icon-fone.jpg" width="39" height="39"> 011. 5567.7890</span>
				<span><img src="imagens/icon-location.jpg" width="39" height="39">  Piso Térreo</span>
				<p> Texto do conteudo menor que vem do dashboard.Texto do conteudo menor que vem do dashboard.</p>
				
		   </div>
		
		<%
		}
		%>
   
   </div><!--produtos--> 
 </div><!--full-->
 
 <script type="text/javascript">
	
	
$(document).ready(function(){
	$("#servico").keyup(function(e){
	  //var selectSize = $(this).val();
	  //filter(selectSize);
	  if (e.which !== 32) {
	  var value = $(this).val();
	  var noWhitespaceValue = value.replace(/\s+/g, '');
	  var noWhitespaceCount = noWhitespaceValue.length;
	  if (noWhitespaceCount > 5) {
		  filter(value.toLowerCase());
	  } else {
		$('.serv').show();
	  }
	  }
	});
});

$('#categoria').on('change', function() {
console.log('estou aqui');
  var value = $(this).val();
  
  if (value==""){
	$('.serv').show();
  } else {
	filter2(value.toLowerCase());
  }
});


function filter(e) {
    var regex = new RegExp('\\b\\w*' + e + '\\w*\\b');
            $('.serv').hide().filter(function () {
        return regex.test($(this).data('nome'))
    }).show();
}

function filter2(e) {
    var regex = new RegExp('\\b\\w*' + e + '\\w*\\b');
            $('.serv').hide().filter(function () {
        return regex.test($(this).data('categoria'))
    }).show();
}

</script>
